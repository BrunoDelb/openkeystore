<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.6.0_11) on Wed Dec 02 18:03:53 CET 2009 -->
<TITLE>
VirtualSE (WebPKI.org Phone JCE)
</TITLE>

<META NAME="date" CONTENT="2009-12-02">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="VirtualSE (WebPKI.org Phone JCE)";
    }
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">
<HR>


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../org/webpki/sks/dbemulator/CryptoDriver.html" title="class in org.webpki.sks.dbemulator"><B>PREV CLASS</B></A>&nbsp;
&nbsp;NEXT CLASS</FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../index.html?org/webpki/sks/dbemulator/VirtualSE.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="VirtualSE.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
org.webpki.sks.dbemulator</FONT>
<BR>
Class VirtualSE</H2>
<PRE>
<A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</A>
  <IMG SRC="../../../../resources/inherit.gif" ALT="extended by "><B>org.webpki.sks.dbemulator.VirtualSE</B>
</PRE>
<HR>
<DL>
<DT><PRE>public class <B>VirtualSE</B><DT>extends <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</A></DL>
</PRE>

<P>
A "Virtual" SE (Security&nbsp;Element).
 &nbsp;<a name="VSE">This class emulates a simple SE where keys
 are stored <i>externally</i>, but encrypted by an AES "master" key inside of the SE.&nbsp;
 The master key is also responsible for verifying the integrity of supplied key objects which is
 done through HMAC signatures.&nbsp;
 In addition to the "master" key,
 there is a device certificate with a corresponding private key,
 primarily intended for &quot;bootstrapping&quot; user-credentials by <i>attesting the
 authenticity of generated keys</i>, <i>preserving message integrity</i>,
 and <i>providing encryption
 for downloaded secrets</i>.&nbsp;
 Using the KeyGen2 provisioning protocol, the latter is limited to PUKs and preset
 PINs.&nbsp;
 Below is a picture of the SE architecture:<p>
 <center><img src="javadoc-tpm-picture.png" title="Security Elements rock!"></center><p>
 Access control including PIN error counting is not a part of this design which is
 intended to provide protection from key theft, but not from key "misuse".&nbsp;
 The latter is intended to be catered for by a trusted layer or virtual machine
 in the operating system itself,
 which also includes a trusted GUI for PIN input etc.&nbsp;
 An unusual feature of this SE design is that supported algorithm IDs are not
 meant to be supplied in the traditional ".h" file, but are discoverable by the SE
 interface software.&nbsp;
 The same applies to the capabilities in terms of key sizes and technologies.&nbsp;
 The described SE scheme is designed to consume as little RAM as is close to theoretically possible,
 and it is also entirely stateless.  Algorithm support is as follows:
 <style type="text/css">
 .dbTR {font-weight:normal;font-size:10pt;font-family:verdana,arial;border-width:1px 1px 1px 0;border-style:solid;border-color:black;padding:4px}
 .dbTL {font-weight:normal;font-size:10pt;font-family:verdana,arial;border-width:1px 1px 1px 1px;border-style:solid;border-color:black;padding:4px}
 .dbNL {font-weight:normal;font-size:10pt;font-family:verdana,arial;border-width:0 1px 1px 1px;border-style:solid;border-color:black;padding:4px} 
 .dbNR {font-weight:normal;font-size:10pt;font-family:verdana,arial;border-width:0 1px 1px 0;border-style:solid;border-color:black;padding:4px}
 .dbLN {font-weight:normal;font-size:10pt;font-family:verdana,arial;border-width:0 1px 1px 1px;border-style:solid;border-color:black;padding:4px}
 </style><p>
 <table cellpadding="0" cellspacing="0">
 <tr>
 <td class="dbTL" align="center" style="background-color:#E0E0E0">Asymmetric Key Encryption</td>
 <td rowspan="2" background="vshaddow.gif" width="2"></td></tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">http://www.w3.org/2001/04/xmlenc#rsa-1_5</td>
 </tr>
 
 <tr><td colspan="2" background="hshaddow.gif" height="2"></td></tr>

 <tr><td colspan="2">&nbsp;</td></tr>
 <tr>
 <td class="dbTL" align="center" style="background-color:#E0E0E0">Asymmetric Key Signatures</td>
 <td rowspan="9" background="vshaddow.gif" width="2"></td></tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">http://www.w3.org/2000/09/xmldsig#rsa-sha1</td>
 </tr>
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">http://www.w3.org/2001/04/xmldsig-more#rsa-sha256</td>
 </tr>
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">http://www.w3.org/2001/04/xmldsig-more#rsa-sha384</td>
 </tr>
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">http://www.w3.org/2001/04/xmldsig-more#rsa-sha512</td>
 </tr>
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha1</td>
 </tr>
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha256</td>
 </tr>
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha384</td>
 </tr>
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha512</td>
 </tr>
 
 <tr><td colspan="2" background="hshaddow.gif" height="2"></td></tr>

 <tr><td colspan="2">&nbsp;</td></tr>
 <tr>
 <td class="dbTL" align="center" style="background-color:#E0E0E0">HMAC Functions</td>
 <td rowspan="6" background="vshaddow.gif" width="2"></td></tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">http://www.w3.org/2001/04/xmldsig-more#hmac-md5</td>
 </tr>
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">http://www.w3.org/2000/09/xmldsig#hmac-sha1</td>
 </tr>
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">http://www.w3.org/2001/04/xmldsig-more#hmac-sha256</td>
 </tr>
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">http://www.w3.org/2001/04/xmldsig-more#hmac-sha384</td>
 </tr>
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">http://www.w3.org/2001/04/xmldsig-more#hmac-sha512</td>
 </tr>

 <tr><td colspan="2" background="hshaddow.gif" height="2"></td></tr>

 <tr><td colspan="2">&nbsp;</td></tr>
 <tr>
 <td class="dbTL" align="center" style="background-color:#E0E0E0">Symmetric Key Encryption &amp; Decryption</td>
 <td rowspan="5" background="vshaddow.gif" width="2"></td></tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">http://www.w3.org/2001/04/xmlenc#aes128-cbc</td>
 </tr>
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">http://www.w3.org/2001/04/xmlenc#aes256-cbc</td>
 </tr>
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">http://www.w3.org/2001/04/xmlenc#kw-aes128</td>
 </tr>
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">http://www.w3.org/2001/04/xmlenc#kw-aes256</td>
 </tr>

 <tr><td colspan="2" background="hshaddow.gif" height="2"></td></tr>

 <tr><td colspan="2">&nbsp;</td></tr>
 <tr>
 <td class="dbTL" align="center" style="background-color:#E0E0E0">Private Key Formats</td>
 <td rowspan="2" background="vshaddow.gif" width="2"></td></tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">http://xmlns.webpki.org/keygen2/1.0#format.pkcs8</td>
 </tr>

 <tr><td colspan="2" background="hshaddow.gif" height="2"></td></tr>

 <tr><td colspan="2">&nbsp;</td></tr>
 <tr>
 <td class="dbTL" align="center" style="background-color:#E0E0E0">KeyGen2 Specific</td>
 <td rowspan="3" background="vshaddow.gif" width="2"></td></tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">http://xmlns.webpki.org/keygen2/1.0#algorithm.key-attestation-1</td>
 </tr>

 <tr bgcolor="ivory">
 <td align="left" class="dbNL">http://xmlns.webpki.org/keygen2/1.0#algorithm.mac-piggyback-1</td>
 </tr>

 <tr><td colspan="2" background="hshaddow.gif" height="2"></td></tr>

 </table><p>
 Not shown in the method descriptions is the error-handling because it is generic: A successful method
 return is prepended with a byte having the value 0, while an error is indicated by the value 1, followed
 by a two-byte length specifier and an UTF-8 encoded error message.
<P>

<P>
<HR>

<P>

<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/webpki/sks/dbemulator/VirtualSE.html#deviceKeyDecrypt(byte[])">deviceKeyDecrypt</A></B>(byte[]&nbsp;parameter_block)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Decrypts data using the device private key.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/webpki/sks/dbemulator/VirtualSE.html#deviceKeyDigestSign(byte[])">deviceKeyDigestSign</A></B>(byte[]&nbsp;parameter_block)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Signs digested data using the device private key.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/webpki/sks/dbemulator/VirtualSE.html#generateAttestedKeyPair(byte[])">generateAttestedKeyPair</A></B>(byte[]&nbsp;parameter_block)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Generates an attested key-pair.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/webpki/sks/dbemulator/VirtualSE.html#getDeviceInformation()">getDeviceInformation</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns device information and capabilities.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/webpki/sks/dbemulator/VirtualSE.html#getNextAlgorithm(byte[])">getNextAlgorithm</A></B>(byte[]&nbsp;parameter_block)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Enumerates supported algorithms.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/webpki/sks/dbemulator/VirtualSE.html#getPackedDeviceCertificatePath()">getPackedDeviceCertificatePath</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the device certificate path.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/webpki/sks/dbemulator/VirtualSE.html#privateKeyDecrypt(byte[])">privateKeyDecrypt</A></B>(byte[]&nbsp;parameter_block)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Decrypts data using a private key.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/webpki/sks/dbemulator/VirtualSE.html#privateKeyDigestSign(byte[])">privateKeyDigestSign</A></B>(byte[]&nbsp;parameter_block)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Signs digested data using a private key.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/webpki/sks/dbemulator/VirtualSE.html#provisionPiggybackedSymmetricKey(byte[])">provisionPiggybackedSymmetricKey</A></B>(byte[]&nbsp;parameter_block)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Provisions a KeyGen2 "piggybacked" symmetric key.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/webpki/sks/dbemulator/VirtualSE.html#sealPrivateKey(byte[])">sealPrivateKey</A></B>(byte[]&nbsp;parameter_block)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Seales a raw private key.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/webpki/sks/dbemulator/VirtualSE.html#sealSecretKey(byte[])">sealSecretKey</A></B>(byte[]&nbsp;parameter_block)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Seales a raw secret key.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/webpki/sks/dbemulator/VirtualSE.html#symmetricKeyEncrypt(byte[])">symmetricKeyEncrypt</A></B>(byte[]&nbsp;parameter_block)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Encrypts or decrypts data using a secret key.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/webpki/sks/dbemulator/VirtualSE.html#symmetricKeyHMAC(byte[])">symmetricKeyHMAC</A></B>(byte[]&nbsp;parameter_block)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a Keyed-Hash Message Authentication Code (HMAC).</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.<A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</A></B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#clone()" title="class or interface in java.lang">clone</A>, <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#equals(java.lang.Object)" title="class or interface in java.lang">equals</A>, <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#finalize()" title="class or interface in java.lang">finalize</A>, <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#getClass()" title="class or interface in java.lang">getClass</A>, <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#hashCode()" title="class or interface in java.lang">hashCode</A>, <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#notify()" title="class or interface in java.lang">notify</A>, <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#notifyAll()" title="class or interface in java.lang">notifyAll</A>, <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#toString()" title="class or interface in java.lang">toString</A>, <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#wait()" title="class or interface in java.lang">wait</A>, <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#wait(long)" title="class or interface in java.lang">wait</A>, <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#wait(long, int)" title="class or interface in java.lang">wait</A></CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="deviceKeyDecrypt(byte[])"><!-- --></A><H3>
deviceKeyDecrypt</H3>
<PRE>
public byte[] <B>deviceKeyDecrypt</B>(byte[]&nbsp;parameter_block)</PRE>
<DL>
<DD>Decrypts data using the device private key.<p>
 <b>Parameters:</b><p>
 <table cellpadding="0" cellspacing="0"><tr>
 <td class="dbTL" align="center" style="background-color:#E0E0E0">Variable&nbsp;Name</td>
 <td class="dbTR" align="center" style="background-color:#E0E0E0">Data&nbsp;Type</td>
 <td class="dbTR" align="center" style="background-color:#E0E0E0">Comment</td>
 <td rowspan="3" background="vshaddow.gif" width="2"></td></tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">data</td>
 <td align="center" class="dbNR">byte[]</td>
 <td align="left" class="dbNR">The data to be decrypted</td>
 </tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">algorithm</td>
 <td align="center" class="dbNR">byte</td>
 <td align="left" class="dbNR">The decryption algorithm in local SE notation.
 Note: due to the fact that device keys also function as key attestation keys,
 only PKCS&nbsp;#1 style of decryption algorithms are accepted.</td>
 </tr>

 <tr><td colspan="4" background="hshaddow.gif" height="2"></td></tr>
 
 </table><p>
 <b>Returns:</b><p>
 <table cellpadding="0" cellspacing="0"><tr>
 <td class="dbTL" align="center" style="background-color:#E0E0E0">Variable&nbsp;Name</td>
 <td class="dbTR" align="center" style="background-color:#E0E0E0">Data&nbsp;Type</td>
 <td class="dbTR" align="center" style="background-color:#E0E0E0">Comment</td>
 <td rowspan="2" background="vshaddow.gif" width="2"></td></tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">result</td>
 <td align="center" class="dbNR">byte[]</td>
 <td align="left" class="dbNR">Decrypted data</td>
 </tr>
 
 <tr><td colspan="4" background="hshaddow.gif" height="2"></td></tr>
 
 </table>
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="deviceKeyDigestSign(byte[])"><!-- --></A><H3>
deviceKeyDigestSign</H3>
<PRE>
public byte[] <B>deviceKeyDigestSign</B>(byte[]&nbsp;parameter_block)</PRE>
<DL>
<DD>Signs digested data using the device private key.<p>
 <b>Parameters:</b><p>
 <table cellpadding="0" cellspacing="0"><tr>
 <td class="dbTL" align="center" style="background-color:#E0E0E0">Variable&nbsp;Name</td>
 <td class="dbTR" align="center" style="background-color:#E0E0E0">Data&nbsp;Type</td>
 <td class="dbTR" align="center" style="background-color:#E0E0E0">Comment</td>
 <td rowspan="4" background="vshaddow.gif" width="2"></td></tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">digest</td>
 <td align="center" class="dbNR">byte[]</td>
 <td align="left" class="dbNR">The digested data to be signed.
 Note that the <code>digest</code> MUST match that of <code>algorithm</code></td>
 </tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">algorithm</td>
 <td align="center" class="dbNR">byte</td>
 <td align="left" class="dbNR">The signature algorithm in local SE notation</td>
 </tr>

 <tr><td colspan="4" background="hshaddow.gif" height="2"></td></tr>
 
 </table><p>
 <b>Returns:</b><p>
 <table cellpadding="0" cellspacing="0"><tr>
 <td class="dbTL" align="center" style="background-color:#E0E0E0">Variable&nbsp;Name</td>
 <td class="dbTR" align="center" style="background-color:#E0E0E0">Data&nbsp;Type</td>
 <td class="dbTR" align="center" style="background-color:#E0E0E0">Comment</td>
 <td rowspan="2" background="vshaddow.gif" width="2"></td></tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">result</td>
 <td align="center" class="dbNR">byte[]</td>
 <td align="left" class="dbNR">Signed data</td>
 </tr>
 
 <tr><td colspan="4" background="hshaddow.gif" height="2"></td></tr>
 
 </table>
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="generateAttestedKeyPair(byte[])"><!-- --></A><H3>
generateAttestedKeyPair</H3>
<PRE>
public byte[] <B>generateAttestedKeyPair</B>(byte[]&nbsp;parameter_block)</PRE>
<DL>
<DD>Generates an attested key-pair.
 <br>Below is a KeyGen2 <code>KeyOperationRequest</code> XML fragment ...
 <pre>  &lt;<font color="#C00000">CreateObject</font>&gt;
     &lt;<font color="#C00000">KeyPair</font> <font color="#0000C0">ID</font>="Key.1" <font color="#0000C0">KeyUsage</font>="authentication" <font color="#0000C0">Exportable</font>="false"&gt;
        &lt;<font color="#C00000">RSA</font> <font color="#0000C0">KeySize</font>="2048"/&gt;
     &lt;/<font color="#C00000">KeyPair</font>&gt;
  &lt;/<font color="#C00000">CreateObject</font>&gt;
</pre><p>
 ... followed by a matching KeyGen2 <code>KeyOperationResponse</code> XML fragment ...
 <pre>  &lt;<font color="#C00000">GeneratedPublicKey</font>&nbsp;<font color="#0000C0">ID</font>="Key.1" <font color="#0000C0">KeyAttestation</font>="FuW0cnn77bT ... sXd47zvG8="&gt;
     &lt;<font color="#008000">ds</font>:<font color="#C00000">KeyInfo</font>&gt;
        &lt;<font color="#008000">ds</font>:<font color="#C00000">KeyValue</font>&gt;
           &lt;<font color="#008000">ds</font>:<font color="#C00000">RSAKeyValue</font>&gt;
              &lt;<font color="#008000">ds</font>:<font color="#C00000">Modulus</font>&gt;AJMYlSOTgea0qep ... zAJvtnCtOZqC4k=&lt;/<font color="#008000">ds</font>:<font color="#C00000">Modulus</font>&gt;
              &lt;<font color="#008000">ds</font>:<font color="#C00000">Exponent</font>&gt;AQAB&lt;/<font color="#008000">ds</font>:<font color="#C00000">Exponent</font>&gt;
           &lt;/<font color="#008000">ds</font>:<font color="#C00000">RSAKeyValue</font>&gt;
        &lt;/<font color="#008000">ds</font>:<font color="#C00000">KeyValue</font>&gt;
     &lt;/<font color="#008000">ds</font>:<font color="#C00000">KeyInfo</font>&gt;
  &lt;/<font color="#C00000">GeneratedPublicKey</font>&gt;
</pre><p>
 Key attestations are performed by the device key.&nbsp;
 For details on the supported attestation mechanism, please consult
 <a href="keygen2-key-attestation-1.pdf" target="_blank"><nobr>keygen2-key-attestation-1.pdf</nobr></a>
 and
 <a href="keygen2-key-archival.pdf" target="_blank"><nobr>keygen2-key-archival.pdf</nobr></a>.<p>
 <b>Parameters:</b><p>
 <table cellpadding="0" cellspacing="0"><tr>
 <td class="dbTL" align="center" style="background-color:#E0E0E0">Variable&nbsp;Name</td>
 <td class="dbTR" align="center" style="background-color:#E0E0E0">Data&nbsp;Type</td>
 <td class="dbTR" align="center" style="background-color:#E0E0E0">Comment</td>
 <td rowspan="14" background="vshaddow.gif" width="2"></td></tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">crypto_family</td>
 <td align="center" class="dbNR">byte</td>
 <td align="left" class="dbNR">Cryptographic family of the key to be generated.
 0x0 = RSA, 0x1 = ECC</td>
 </tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">size</td>
 <td align="center" class="dbNR">short</td>
 <td align="left" class="dbNR"><i>RSA only</i>: Length of the RSA key to be generated</td>
 </tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">optional_exponent</td>
 <td align="center" class="dbNR">byte[]</td>
 <td align="left" class="dbNR"><i>RSA only</i>: A BigInteger.toByteArray () or byte[0] holding an optional exponent value</td>
 </tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">named_curve</td>
 <td align="center" class="dbNR">byte[]</td>
 <td align="left" class="dbNR"><i>ECC only</i>: An UTF-8 encoded string holding the OID of the requested curve</td>
 </tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">attestation_algorithm</td>
 <td align="center" class="dbNR">byte</td>
 <td align="left" class="dbNR">Key attestation algorithm in local SE notation.&nbsp;
 Currently only <code><nobr>http://xmlns.webpki.org/keygen2/1.0#algorithm.key-attestation-1</nobr></code>
 is supported</td>
 </tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">exportable</td>
 <td align="center" class="dbNR">byte</td>
 <td align="left" class="dbNR">This flag should be 0x01 for exportable keys otherwise it should be 0x00</td>
 </tr>

 <tr bgcolor="ivory">
 <td align="left" class="dbNL">key_usage</td>
 <td align="center" class="dbNR">byte</td>
 <td align="left" class="dbNR">This byte sets restrictions on the use of the private key</td>
 </tr>

 <tr bgcolor="ivory">
 <td align="left" class="dbNL">nonce</td>
 <td align="center" class="dbNR">byte[]</td>
 <td align="left" class="dbNR">Nonce data</td>
 </tr>

 <tr bgcolor="ivory">
 <td align="center" colspan="3" class="dbLN"><i>The following elements are only defined if the private key should be archived</i></td>
 </tr>

 <tr bgcolor="ivory">
 <td align="left" class="dbNL">archival_key</td>
 <td align="center" class="dbNR">byte[]</td>
 <td align="left" class="dbNR">Archival public key in X.509 DER encoding.
 &nbsp;This argument is only permitted for keys with <code>key_usage</code> set to encryption</td>
 </tr>

 <tr bgcolor="ivory">
 <td align="left" class="dbNL">private_key_format</td>
 <td align="center" class="dbNR">byte</td>
 <td align="left" class="dbNR">Unencrypted private key format in local SE notation to use
 when creating <code>encrypted_private_key</code>.&nbsp;
 Currently only <code><nobr>http://xmlns.webpki.org/keygen2/1.0#format.pkcs8</nobr></code> and
 is supported</td>

 <tr bgcolor="ivory">
 <td align="left" class="dbNL">encryption_algorithm</td>
 <td align="center" class="dbNR">byte</td>
 <td align="left" class="dbNR">Symmetric key algorithm in local SE notation to use
 for creating <code>encrypted_private_key</code>.&nbsp;
 Currently only <code><nobr>http://www.w3.org/2001/04/xmlenc#aes128-cbc</nobr></code> and
 <code><nobr>http://www.w3.org/2001/04/xmlenc#aes256-cbc</nobr></code> are supported</td>
 </tr>

 <tr bgcolor="ivory">
 <td align="left" class="dbNL">key_wrap_algorithm</td>
 <td align="center" class="dbNR">byte</td>
 <td align="left" class="dbNR">Public key algorithm in local SE notation to use with <code>archival_key</code>
 for creating <code>wrapped_encryption_key</code>.&nbsp;
 Currently only <code><nobr>http://www.w3.org/2001/04/xmlenc#rsa-1_5</nobr></code> is supported</td>
 </tr>

 <tr><td colspan="4" background="hshaddow.gif" height="2"></td></tr>
 
 </table><p>
 <b>Returns:</b><p>
 <table cellpadding="0" cellspacing="0"><tr>
 <td class="dbTL" align="center" style="background-color:#E0E0E0">Variable&nbsp;Name</td>
 <td class="dbTR" align="center" style="background-color:#E0E0E0">Data&nbsp;Type</td>
 <td class="dbTR" align="center" style="background-color:#E0E0E0">Comment</td>
 <td rowspan="7" background="vshaddow.gif" width="2"></td></tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">public_key</td>
 <td align="center" class="dbNR">byte[]</td>
 <td align="left" class="dbNR">Generated public key in X.509 DER encoding</td>
 </tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">private_key_handle</td>
 <td align="center" class="dbNR">byte[]</td>
 <td align="left" class="dbNR">Sealed private key</td>
 </tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">attest_signature</td>
 <td align="center" class="dbNR">byte[]</td>
 <td align="left" class="dbNR">Signature attesting that the key-pair was generated inside of the SE
 </tr>
 
 <tr bgcolor="ivory">
 <td align="center" colspan="3" class="dbLN"><i>The following elements are
 only available for private keys that should be archived</i></td>
 </tr>

 <tr bgcolor="ivory">
 <td align="left" class="dbNL">encrypted_private_key</td>
 <td align="center" class="dbNR">byte[]</td>
 <td align="left" class="dbNR">Private key encrypted by a random symmetric key using
 <code>encryption_algorithm</code></td>
 </tr>

 <tr bgcolor="ivory">
 <td align="left" class="dbNL">wrapped_encryption_key</td>
 <td align="center" class="dbNR">byte[]</td>
 <td align="left" class="dbNR">The random symmetric key encrypted using
 <code>key_wrap_algorithm</code> by the <code>archival_key</code></td>
 </tr>

 <tr><td colspan="4" background="hshaddow.gif" height="2"></td></tr>
 
 </table>
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="getDeviceInformation()"><!-- --></A><H3>
getDeviceInformation</H3>
<PRE>
public static byte[] <B>getDeviceInformation</B>()</PRE>
<DL>
<DD>Returns device information and capabilities.<p>
 <b>Returns:</b><p>
 <table cellpadding="0" cellspacing="0"><tr>
 <td class="dbTL" align="center" style="background-color:#E0E0E0">Variable&nbsp;Name</td>
 <td class="dbTR" align="center" style="background-color:#E0E0E0">Data&nbsp;Type</td>
 <td class="dbTR" align="center" style="background-color:#E0E0E0">Comment</td>
 <td rowspan="6" background="vshaddow.gif" width="2"></td></tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">device_info</td>
 <td align="center" class="dbNR">byte[]</td>
 <td align="left" class="dbNR">A device-description in UTF-8 encoding</td>
 </tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">rsa_capabilities</td>
 <td align="center" class="dbNR">byte</td>
 <td align="left" class="dbNR">Holds the number of <code>rsa_capability</code> elements</td>
 </tr>

 <tr bgcolor="ivory">
 <td align="left" class="dbNL">rsa_capability</td>
 <td align="center" class="dbNR">short</td>
 <td align="left" class="dbNR">A coded object where the lowest 14 bits hold the supported key-size, while
 bit 15 indicates if there is support for setting exponent during key-generation.
 Note: this object is repeated for each supported size</td>
 </tr>

 <tr bgcolor="ivory">
 <td align="left" class="dbNL">ecc_capabilities</td>
 <td align="center" class="dbNR">byte</td>
 <td align="left" class="dbNR">Holds the number of <code>ecc_capability</code> elements</td>
 </tr>

 <tr bgcolor="ivory">
 <td align="left" class="dbNL">ecc_capability</td>
 <td align="center" class="dbNR">byte[]</td>
 <td align="left" class="dbNR">An UTF-8 encoded string holding the OID of a supported curve</td>
 </tr>
 
 <tr><td colspan="4" background="hshaddow.gif" height="2"></td></tr>
 
 </table>
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="getNextAlgorithm(byte[])"><!-- --></A><H3>
getNextAlgorithm</H3>
<PRE>
public static byte[] <B>getNextAlgorithm</B>(byte[]&nbsp;parameter_block)</PRE>
<DL>
<DD>Enumerates supported algorithms.<p>
 This method assumes that the invoker starts by setting the <code>previous_algorithm_id</code>
 to <code>0xff</code> and then use the returned <code>algorithm_id</code> value as input to the next call.
 This process should end when an <code>algorithm_uri</code> with zero length has been found.
 The purpose of the <code>getNextAlgorithm</code> method is finding out the mappings
 (and the capabilities...) in order to supply the proper SE local algorithm IDs
 required by most other SE methods.<p>
 <b>Parameters:</b><p>
 <table cellpadding="0" cellspacing="0"><tr>
 <td class="dbTL" align="center" style="background-color:#E0E0E0">Variable&nbsp;Name</td>
 <td class="dbTR" align="center" style="background-color:#E0E0E0">Data&nbsp;Type</td>
 <td class="dbTR" align="center" style="background-color:#E0E0E0">Comment</td>
 <td rowspan="3" background="vshaddow.gif" width="2"></td></tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">previous_algorithm_id</td>
 <td align="center" class="dbNR">byte</td>
 <td align="left" class="dbNR">Algorithm ID in SE local notation</td>
 </tr>

 <tr><td colspan="4" background="hshaddow.gif" height="2"></td></tr>
 
 </table><p>
 <b>Returns:</b><p>
 <table cellpadding="0" cellspacing="0"><tr>
 <td class="dbTL" align="center" style="background-color:#E0E0E0">Variable&nbsp;Name</td>
 <td class="dbTR" align="center" style="background-color:#E0E0E0">Data&nbsp;Type</td>
 <td class="dbTR" align="center" style="background-color:#E0E0E0">Comment</td>
 <td rowspan="4" background="vshaddow.gif" width="2"></td></tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">algorithm_uri</td>
 <td align="center" class="dbNR">byte[]</td>
 <td align="left" class="dbNR">Algorithm URI in UTF-8 coding</td>
 </tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">algorithm_id</td>
 <td align="center" class="dbNR">byte</td>
 <td align="left" class="dbNR">Algorithm ID in SE local notation</td>
 </tr>
 
 <tr><td colspan="4" background="hshaddow.gif" height="2"></td></tr>
 
 </table>
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="getPackedDeviceCertificatePath()"><!-- --></A><H3>
getPackedDeviceCertificatePath</H3>
<PRE>
public byte[] <B>getPackedDeviceCertificatePath</B>()</PRE>
<DL>
<DD>Returns the device certificate path.<p>
 <b>Returns:</b><p>
 <table cellpadding="0" cellspacing="0"><tr>
 <td class="dbTL" align="center" style="background-color:#E0E0E0">Variable&nbsp;Name</td>
 <td class="dbTR" align="center" style="background-color:#E0E0E0">Data&nbsp;Type</td>
 <td class="dbTR" align="center" style="background-color:#E0E0E0">Comment</td>
 <td rowspan="2" background="vshaddow.gif" width="2"></td></tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">result</td>
 <td align="center" class="dbNR">byte[]</td>
 <td align="left" class="dbNR">Device certificate path.
 It may as a minimum hold the end-entity certificate.</td>
 </tr>
 
 <tr><td colspan="4" background="hshaddow.gif" height="2"></td></tr>
 
 </table>
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="privateKeyDecrypt(byte[])"><!-- --></A><H3>
privateKeyDecrypt</H3>
<PRE>
public static byte[] <B>privateKeyDecrypt</B>(byte[]&nbsp;parameter_block)</PRE>
<DL>
<DD>Decrypts data using a private key.<p>
 <b>Parameters:</b><p>
 <table cellpadding="0" cellspacing="0"><tr>
 <td class="dbTL" align="center" style="background-color:#E0E0E0">Variable&nbsp;Name</td>
 <td class="dbTR" align="center" style="background-color:#E0E0E0">Data&nbsp;Type</td>
 <td class="dbTR" align="center" style="background-color:#E0E0E0">Comment</td>
 <td rowspan="5" background="vshaddow.gif" width="2"></td></tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">data</td>
 <td align="center" class="dbNR">byte[]</td>
 <td align="left" class="dbNR">The data to be signed</td>
 </tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">private_key_handle</td>
 <td align="center" class="dbNR">byte[]</td>
 <td align="left" class="dbNR">The sealed signature key</td>
 </tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">algorithm</td>
 <td align="center" class="dbNR">byte</td>
 <td align="left" class="dbNR">The decryption algorithm in local SE notation</td>
 </tr>

 <tr><td colspan="4" background="hshaddow.gif" height="2"></td></tr>
 
 </table><p>
 <b>Returns:</b><p>
 <table cellpadding="0" cellspacing="0"><tr>
 <td class="dbTL" align="center" style="background-color:#E0E0E0">Variable&nbsp;Name</td>
 <td class="dbTR" align="center" style="background-color:#E0E0E0">Data&nbsp;Type</td>
 <td class="dbTR" align="center" style="background-color:#E0E0E0">Comment</td>
 <td rowspan="2" background="vshaddow.gif" width="2"></td></tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">result</td>
 <td align="center" class="dbNR">byte[]</td>
 <td align="left" class="dbNR">Decrypted data</td>
 </tr>
 
 <tr><td colspan="4" background="hshaddow.gif" height="2"></td></tr>
 
 </table>
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="privateKeyDigestSign(byte[])"><!-- --></A><H3>
privateKeyDigestSign</H3>
<PRE>
public static byte[] <B>privateKeyDigestSign</B>(byte[]&nbsp;parameter_block)</PRE>
<DL>
<DD>Signs digested data using a private key.<p>
 <b>Parameters:</b><p>
 <table cellpadding="0" cellspacing="0"><tr>
 <td class="dbTL" align="center" style="background-color:#E0E0E0">Variable&nbsp;Name</td>
 <td class="dbTR" align="center" style="background-color:#E0E0E0">Data&nbsp;Type</td>
 <td class="dbTR" align="center" style="background-color:#E0E0E0">Comment</td>
 <td rowspan="5" background="vshaddow.gif" width="2"></td></tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">digest</td>
 <td align="center" class="dbNR">byte[]</td>
 <td align="left" class="dbNR">The digested data to be signed.
 Note that the <code>digest</code> MUST match that of <code>algorithm</code></td>
 </tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">private_key_handle</td>
 <td align="center" class="dbNR">byte[]</td>
 <td align="left" class="dbNR">The sealed signature key</td>
 </tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">algorithm</td>
 <td align="center" class="dbNR">byte</td>
 <td align="left" class="dbNR">The signature algorithm in local SE notation</td>
 </tr>

 <tr><td colspan="4" background="hshaddow.gif" height="2"></td></tr>
 
 </table><p>
 <b>Returns:</b><p>
 <table cellpadding="0" cellspacing="0"><tr>
 <td class="dbTL" align="center" style="background-color:#E0E0E0">Variable&nbsp;Name</td>
 <td class="dbTR" align="center" style="background-color:#E0E0E0">Data&nbsp;Type</td>
 <td class="dbTR" align="center" style="background-color:#E0E0E0">Comment</td>
 <td rowspan="2" background="vshaddow.gif" width="2"></td></tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">result</td>
 <td align="center" class="dbNR">byte[]</td>
 <td align="left" class="dbNR">Signed data</td>
 </tr>
 
 <tr><td colspan="4" background="hshaddow.gif" height="2"></td></tr>
 
 </table>
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="provisionPiggybackedSymmetricKey(byte[])"><!-- --></A><H3>
provisionPiggybackedSymmetricKey</H3>
<PRE>
public static byte[] <B>provisionPiggybackedSymmetricKey</B>(byte[]&nbsp;parameter_block)</PRE>
<DL>
<DD>Provisions a KeyGen2 "piggybacked" symmetric key. Below is an example:      
 <pre>  &lt;<font color="#C00000">CertifiedPublicKey</font> <font color="#0000C0">ID</font>="Key.1"&gt;
     &lt;<font color="#008000">ds</font>:<font color="#C00000">X509Data</font>&gt;
        &lt;<font color="#008000">ds</font>:<font color="#C00000">X509Certificate</font>&gt;MIIDnTCCAo...fCc6PBLPWMYn4dPY=&lt;/<font color="#008000">ds</font>:<font color="#C00000">X509Certificate</font>&gt;
     &lt;/<font color="#008000">ds</font>:<font color="#C00000">X509Data</font>&gt;
     &lt;<font color="#C00000">PiggybackedSymmetricKey</font> <font color="#0000C0">EndorsedAlgorithms</font>="http://www.w3.org/2000/09/xmldsig#hmac-sha1"
                              <font color="#0000C0">MAC</font>="14z1RfdoVeDqYfSviPWZD4c2AL4="&gt;
        &lt;<font color="#008000">xenc</font>:<font color="#C00000">EncryptedKey</font>&gt;
           &lt;<font color="#008000">xenc</font>:<font color="#C00000">EncryptionMethod</font> <font color="#0000C0">Algorithm</font>="http://www.w3.org/2001/04/xmlenc#rsa-1_5"/&gt;
           &lt;<font color="#008000">xenc</font>:<font color="#C00000">CipherData</font>&gt;
              &lt;<font color="#008000">xenc</font>:<font color="#C00000">CipherValue</font>&gt;VA2TbKUq...HQk9HoOIwCeSs=&lt;/<font color="#008000">xenc</font>:<font color="#C00000">CipherValue</font>&gt;
           &lt;/<font color="#008000">xenc</font>:<font color="#C00000">CipherData</font>&gt;
        &lt;/<font color="#008000">xenc</font>:<font color="#C00000">EncryptedKey</font>&gt;
     &lt;/<font color="#C00000">PiggybackedSymmetricKey</font>&gt;
  &lt;/<font color="#C00000">CertifiedPublicKey</font>&gt;
</pre>
<p>
 <b>Parameters:</b><p>
 <table cellpadding="0" cellspacing="0"><tr>
 <td class="dbTL" align="center" style="background-color:#E0E0E0">Variable&nbsp;Name</td>
 <td class="dbTR" align="center" style="background-color:#E0E0E0">Data&nbsp;Type</td>
 <td class="dbTR" align="center" style="background-color:#E0E0E0">Comment</td>
 <td rowspan="8" background="vshaddow.gif" width="2"></td></tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">piggyback_mac_algorithm</td>
 <td align="center" class="dbNR">byte</td>
 <td align="left" class="dbNR">Key &quot;piggyback&quot; MAC algorithm in local SE notation.&nbsp;
 Currently only <code><nobr>http://xmlns.webpki.org/keygen2/1.0#algorithm.mac-piggyback-1</nobr></code>
 is supported</td>
 </tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">encryption_algorithm</td>
 <td align="center" class="dbNR">byte</td>
 <td align="left" class="dbNR">The XML encryption <code>Algorithm</code> expressed in local SE notation.&nbsp;
 Currently only <code><nobr>http://www.w3.org/2001/04/xmlenc#rsa-1_5</nobr></code> is supported</td>
 </tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">encrypted_symmetric_key</td>
 <td align="center" class="dbNR">byte[]</td>
 <td align="left" class="dbNR">The encrypted data as featured in the <code>CipherValue</code> element</td>
 </tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">private_key_handle</td>
 <td align="center" class="dbNR">byte[]</td>
 <td align="left" class="dbNR">The sealed private key associated with the <code>CertifiedPublicKey</code>
 element embedding the <code>PiggybackedSymmetricKey</code> element</td>
 </tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">endorsed_algorithms</td>
 <td align="center" class="dbNR">byte[]</td>
 <td align="left" class="dbNR">An array of SE-local identifiers to 
 the <code>EndorsedAlgorithms</code> as declared in the <code>PiggybackedSymmetricKey</code> element
 where the algorithm URIs have been sorted in alphabetical order</td>
 </tr>

 <tr bgcolor="ivory">
 <td align="left" class="dbNL">mac</td>
 <td align="center" class="dbNR">byte[]</td>
 <td align="left" class="dbNR">The <code>MAC</code> as declared in the
 <code>PiggybackedSymmetricKey</code> element.
 </tr>

 <tr bgcolor="ivory">
 <td align="left" class="dbNL">nonce</td>
 <td align="center" class="dbNR">byte[]</td>
 <td align="left" class="dbNR">Nonce data</td>
 </tr>

 <tr><td colspan="4" background="hshaddow.gif" height="2"></td></tr>
 
 </table><p>
 <b>Returns:</b><p>
 <table cellpadding="0" cellspacing="0"><tr>
 <td class="dbTL" align="center" style="background-color:#E0E0E0">Variable&nbsp;Name</td>
 <td class="dbTR" align="center" style="background-color:#E0E0E0">Data&nbsp;Type</td>
 <td class="dbTR" align="center" style="background-color:#E0E0E0">Comment</td>
 <td rowspan="2" background="vshaddow.gif" width="2"></td></tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">secret_key_handle</td>
 <td align="center" class="dbNR">byte[]</td>
 <td align="left" class="dbNR">Sealed secret key</td>
 </tr>
 
 <tr><td colspan="4" background="hshaddow.gif" height="2"></td></tr>
 
 </table>
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="sealPrivateKey(byte[])"><!-- --></A><H3>
sealPrivateKey</H3>
<PRE>
public static byte[] <B>sealPrivateKey</B>(byte[]&nbsp;parameter_block)</PRE>
<DL>
<DD>Seales a raw private key.<p>
 <b>Parameters:</b><p>
 <table cellpadding="0" cellspacing="0"><tr>
 <td class="dbTL" align="center" style="background-color:#E0E0E0">Variable&nbsp;Name</td>
 <td class="dbTR" align="center" style="background-color:#E0E0E0">Data&nbsp;Type</td>
 <td class="dbTR" align="center" style="background-color:#E0E0E0">Comment</td>
 <td rowspan="4" background="vshaddow.gif" width="2"></td></tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">encoded_private_key</td>
 <td align="center" class="dbNR">byte[]</td>
 <td align="left" class="dbNR">The unprotected private key</td>
 </tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">exportable</td>
 <td align="center" class="dbNR">byte</td>
 <td align="left" class="dbNR">This flag should be 0x01 for exportable keys otherwise it should be 0x00</td>
 </tr>

 <tr bgcolor="ivory">
 <td align="left" class="dbNL">key_usage</td>
 <td align="center" class="dbNR">byte</td>
 <td align="left" class="dbNR">See <A HREF="../../../../org/webpki/sks/dbemulator/VirtualSE.html#generateAttestedKeyPair(byte[])"><CODE>generateAttestedKeyPair</CODE></A></td>
 </tr>

 <tr><td colspan="4" background="hshaddow.gif" height="2"></td></tr>
 
 </table><p>
 <b>Returns:</b><p>
 <table cellpadding="0" cellspacing="0"><tr>
 <td class="dbTL" align="center" style="background-color:#E0E0E0">Variable&nbsp;Name</td>
 <td class="dbTR" align="center" style="background-color:#E0E0E0">Data&nbsp;Type</td>
 <td class="dbTR" align="center" style="background-color:#E0E0E0">Comment</td>
 <td rowspan="2" background="vshaddow.gif" width="2"></td></tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">private_key_handle</td>
 <td align="center" class="dbNR">byte[]</td>
 <td align="left" class="dbNR">Sealed private key</td>
 </tr>
 
 <tr><td colspan="4" background="hshaddow.gif" height="2"></td></tr>
 
 </table>
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="sealSecretKey(byte[])"><!-- --></A><H3>
sealSecretKey</H3>
<PRE>
public static byte[] <B>sealSecretKey</B>(byte[]&nbsp;parameter_block)</PRE>
<DL>
<DD>Seales a raw secret key.<p>
 <b>Parameters:</b><p>
 <table cellpadding="0" cellspacing="0"><tr>
 <td class="dbTL" align="center" style="background-color:#E0E0E0">Variable&nbsp;Name</td>
 <td class="dbTR" align="center" style="background-color:#E0E0E0">Data&nbsp;Type</td>
 <td class="dbTR" align="center" style="background-color:#E0E0E0">Comment</td>
 <td rowspan="4" background="vshaddow.gif" width="2"></td></tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">secret_key</td>
 <td align="center" class="dbNR">byte[]</td>
 <td align="left" class="dbNR">The raw secret key</td>
 </tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">exportable</td>
 <td align="center" class="dbNR">byte</td>
 <td align="left" class="dbNR">This flag should be 0x01 for exportable keys otherwise it should be 0x00</td>
 </tr>

 <tr bgcolor="ivory">
 <td align="left" class="dbNL">endorsed_algorithms</td>
 <td align="center" class="dbNR">byte[]</td>
 <td align="left" class="dbNR">An array of endorsed algorithms in local SE-notation.
 A zero-length array indicates "unrestricted" algorithm usage</td>
 </tr>
 
 <tr><td colspan="4" background="hshaddow.gif" height="2"></td></tr>
 
 </table><p>
 <b>Returns:</b><p>
 <table cellpadding="0" cellspacing="0"><tr>
 <td class="dbTL" align="center" style="background-color:#E0E0E0">Variable&nbsp;Name</td>
 <td class="dbTR" align="center" style="background-color:#E0E0E0">Data&nbsp;Type</td>
 <td class="dbTR" align="center" style="background-color:#E0E0E0">Comment</td>
 <td rowspan="2" background="vshaddow.gif" width="2"></td></tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">secret_key_handle</td>
 <td align="center" class="dbNR">byte[]</td>
 <td align="left" class="dbNR">Sealed secret key</td>
 </tr>
 
 <tr><td colspan="4" background="hshaddow.gif" height="2"></td></tr>
 
 </table>
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="symmetricKeyEncrypt(byte[])"><!-- --></A><H3>
symmetricKeyEncrypt</H3>
<PRE>
public static byte[] <B>symmetricKeyEncrypt</B>(byte[]&nbsp;parameter_block)</PRE>
<DL>
<DD>Encrypts or decrypts data using a secret key.<p>
 <b>Parameters:</b><p>
 <table cellpadding="0" cellspacing="0"><tr>
 <td class="dbTL" align="center" style="background-color:#E0E0E0">Variable&nbsp;Name</td>
 <td class="dbTR" align="center" style="background-color:#E0E0E0">Data&nbsp;Type</td>
 <td class="dbTR" align="center" style="background-color:#E0E0E0">Comment</td>
 <td rowspan="6" background="vshaddow.gif" width="2"></td></tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">encrypt_flag</td>
 <td align="center" class="dbNR">byte</td>
 <td align="left" class="dbNR">This flag should be 0x01 for encryption and 0x00 for decryption</td>
 </tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">data</td>
 <td align="center" class="dbNR">byte[]</td>
 <td align="left" class="dbNR">The data to be encrypted or decrypted.
 Note: the length may not exceed 3500 bytes</td>
 </tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">secret_key_handle</td>
 <td align="center" class="dbNR">byte[]</td>
 <td align="left" class="dbNR">The sealed encryption key</td>
 </tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">algorithm</td>
 <td align="center" class="dbNR">byte</td>
 <td align="left" class="dbNR">The encryption algorithm in local SE notation</td>
 </tr>

 <tr bgcolor="ivory">
 <td align="left" class="dbNL">iv</td>
 <td align="center" class="dbNR">byte[]</td>
 <td align="left" class="dbNR">Optional IV vector.  MUST be byte[0] for algorithms not requiring an IV</td>
 </tr>

 <tr><td colspan="4" background="hshaddow.gif" height="2"></td></tr>
 
 </table><p>
 <b>Returns:</b><p>
 <table cellpadding="0" cellspacing="0"><tr>
 <td class="dbTL" align="center" style="background-color:#E0E0E0">Variable&nbsp;Name</td>
 <td class="dbTR" align="center" style="background-color:#E0E0E0">Data&nbsp;Type</td>
 <td class="dbTR" align="center" style="background-color:#E0E0E0">Comment</td>
 <td rowspan="2" background="vshaddow.gif" width="2"></td></tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">result</td>
 <td align="center" class="dbNR">byte[]</td>
 <td align="left" class="dbNR">Encrypted or decrypted data</td>
 </tr>
 
 <tr><td colspan="4" background="hshaddow.gif" height="2"></td></tr>
 
 </table>
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="symmetricKeyHMAC(byte[])"><!-- --></A><H3>
symmetricKeyHMAC</H3>
<PRE>
public static byte[] <B>symmetricKeyHMAC</B>(byte[]&nbsp;parameter_block)</PRE>
<DL>
<DD>Creates a Keyed-Hash Message Authentication Code (HMAC).<p>
 <b>Parameters:</b><p>
 <table cellpadding="0" cellspacing="0"><tr>
 <td class="dbTL" align="center" style="background-color:#E0E0E0">Variable&nbsp;Name</td>
 <td class="dbTR" align="center" style="background-color:#E0E0E0">Data&nbsp;Type</td>
 <td class="dbTR" align="center" style="background-color:#E0E0E0">Comment</td>
 <td rowspan="5" background="vshaddow.gif" width="2"></td></tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">data</td>
 <td align="center" class="dbNR">byte[]</td>
 <td align="left" class="dbNR">The data to generate a HMAC of.
 Note: the length may not exceed 3500 bytes</td>
 </tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">secret_key_handle</td>
 <td align="center" class="dbNR">byte[]</td>
 <td align="left" class="dbNR">The sealed secret key used as HMAC key</td>
 </tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">algorithm</td>
 <td align="center" class="dbNR">byte</td>
 <td align="left" class="dbNR">The HMAC algorithm in local SE notation</td>
 </tr>

 <tr><td colspan="4" background="hshaddow.gif" height="2"></td></tr>
 
 </table><p>
 <b>Returns:</b><p>
 <table cellpadding="0" cellspacing="0"><tr>
 <td class="dbTL" align="center" style="background-color:#E0E0E0">Variable&nbsp;Name</td>
 <td class="dbTR" align="center" style="background-color:#E0E0E0">Data&nbsp;Type</td>
 <td class="dbTR" align="center" style="background-color:#E0E0E0">Comment</td>
 <td rowspan="2" background="vshaddow.gif" width="2"></td></tr>
 
 <tr bgcolor="ivory">
 <td align="left" class="dbNL">result</td>
 <td align="center" class="dbNR">byte[]</td>
 <td align="left" class="dbNR">HMAC data</td>
 </tr>
 
 <tr><td colspan="4" background="hshaddow.gif" height="2"></td></tr>
 
 </table>
<P>
<DD><DL>
</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../org/webpki/sks/dbemulator/CryptoDriver.html" title="class in org.webpki.sks.dbemulator"><B>PREV CLASS</B></A>&nbsp;
&nbsp;NEXT CLASS</FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../index.html?org/webpki/sks/dbemulator/VirtualSE.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="VirtualSE.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>
<i>2006-2009 WebPKI.org</i>
</BODY>
</HTML>
